{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",
    "extends": [
        "github>SonarSource/renovate-config:slim",
        ":maintainLockFilesWeekly",
        ":enablePreCommit",
        "docker:enableMajor",
        "docker:pinDigests"
    ],
    "enabledManagers": ["github-actions", "regex"],
    "github-actions": {
        "fileMatch": ["^(github-action)(\\/[^/]+)?\\/action\\.ya?ml$"]
    },
    "packageRules": [
        {
            "matchManagers": ["regex"],
            "matchFileNames": [".*pkrvars.hcl$", ".*tfvars$"],
            "addLabels": ["golden-ami"]
        }
    ],
    "regexManagers": [
        {
            "fileMatch": [".*pkrvars.hcl$", ".*tfvars$"],
            "matchStrings": [
                ".*amiFilter=(?<packageName>.*?)\\n(.*currentImageName=(?<currentDigest>.*?)\\n)?(.*\\n)?.*?(?<depName>[a-zA-Z0-9-_:]*)[ ]*?[:|=][ ]*?[\\\"|\"]?(?<currentValue>ami-[a-z0-9]{17})[\\\"|\"]?.*"
            ],
            "datasourceTemplate": "aws-machine-image",
            "versioningTemplate": "aws-machine-image"
        }
    ]
}
